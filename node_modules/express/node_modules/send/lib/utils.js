
/**
<<<<<<< HEAD
 * Return an ETag in the form of `"<size>-<mtime>"`
 * from the given `stat`.
 *
=======
 * Module dependencies.
 */

var crypto = require('crypto');

/**
 * Return a weak ETag from the given `path` and `stat`.
 *
 * @param {String} path
>>>>>>> deebb5634c25dcf834c39a31b858fc470585fdb3
 * @param {Object} stat
 * @return {String}
 * @api private
 */

<<<<<<< HEAD
exports.etag = function(stat) {
  return '"' + stat.size + '-' + Number(stat.mtime) + '"';
=======
exports.etag = function etag(path, stat) {
  var tag = String(stat.mtime.getTime()) + ':' + String(stat.size) + ':' + path;
  var str = crypto
    .createHash('md5')
    .update(tag, 'utf8')
    .digest('base64');
  return 'W/"' + str + '"';
>>>>>>> deebb5634c25dcf834c39a31b858fc470585fdb3
};

/**
 * decodeURIComponent.
 *
 * Allows V8 to only deoptimize this fn instead of all
 * of send().
 *
 * @param {String} path
 * @api private
 */

exports.decode = function(path){
  try {
    return decodeURIComponent(path);
  } catch (err) {
    return -1;
  }
};
<<<<<<< HEAD

/**
 * Escape the given string of `html`.
 *
 * @param {String} html
 * @return {String}
 * @api private
 */

exports.escape = function(html){
  return String(html)
    .replace(/&(?!\w+;)/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;');
};
=======
>>>>>>> deebb5634c25dcf834c39a31b858fc470585fdb3
